# Messaging Processing System (Goka + Kafka)

## üß† –û–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–∞–±–æ—Ä –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ Go —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Goka –∏ Kafka. –õ–æ–≥–∏–∫–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º:

### üì§ emitter
–ü—É–±–ª–∏–∫—É–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (`model.Message`) –≤ —Ç–æ–ø–∏–∫ Kafka (`messages`). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –Ω–∞—á–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ –ø–æ—Ç–æ–∫–∞.

### üîç censor
–ü–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏—Ö –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö —Å–ª–æ–≤ (`deny words`) –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ `filtered-messages`. –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ `messages-table`.

### ‚õî blocker
–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —Ç–æ–ø–∏–∫—É `blocked-users`, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤ `blocked-users-table`, –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

### üß™ filter
–û–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã censor –∏ blocker. –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ—à–ª–æ —Ü–µ–Ω–∑—É—Ä—É –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω ‚Äî –æ–Ω–æ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –¥–∞–ª—å—à–µ –≤ `clean-messages`.

### üë§ user
–û–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Äî –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å –∏—Ö —Å—Ç–∞—Ç—É—Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —á–µ—Ä–µ–∑ Kafka-—Ç–æ–ø–∏–∫–∏. –¢–∞–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `blocked-users-table`) –∏—Å–ø–æ–ª—å–∑—É—é—Ç `cleanup.policy=compact`.

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

–ó–∞–ø—É—Å–∫ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é Docker Compose

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–∏–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω—ã –∫–æ–Ω—Å–æ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–µ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `cmd/`.

–î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–ø—É—Å—Ç–∏:

```bash
go run ./cmd/blocker -author 1 -recipient 2 -action block -stream blocked-users
go run ./cmd/blocker -author 1 -recipient 2 -action unblock -stream blocked-users
```

- `author` ‚Äî ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∏–Ω–∏—Ü–∏–∏—Ä—É—é—â–µ–≥–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É.
- `recipient` ‚Äî ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–æ–≥–æ –±–ª–æ–∫–∏—Ä—É—é—Ç –∏–ª–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É—é—Ç.
- `action` ‚Äî –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: `block` –∏–ª–∏ `unblock`.
- `stream` ‚Äî –∏–º—è Kafka-—Ç–æ–ø–∏–∫–∞ –¥–ª—è —Å–æ–±—ã—Ç–∏–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `blocked-users`).

–î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–æ–º –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö/—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö —Å–ª–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ —Ü–µ–Ω–∑—É—Ä—ã, –∏—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–∞–Ω–¥—É:

```bash
go run ./cmd/censor -word —Å–ª–æ–≤–æ -action deny -stream deny-words
go run ./cmd/censor -word —Å–ª–æ–≤–æ -action permit -stream deny-words
```

- `word` ‚Äî —Å–ª–æ–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –∏–ª–∏ —Ä–∞–∑—Ä–µ—à–∏—Ç—å.
- `action` ‚Äî `deny` –∏–ª–∏ `permit`.
- `stream` ‚Äî –∏–º—è Kafka-—Ç–æ–ø–∏–∫–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –∫–æ–º–∞–Ω–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `deny-words`).

## –ê–Ω–∞–ª–∏–∑ –∏ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é ksqlDB

- –î–∞–Ω–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ —Å–¥–µ–ª–∞–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–æ–ø–∏–∫ messages
- –ü–æ—ç—Ç–æ–º—É –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–æ–¥–Ω–∏–º–∞—Ç—å –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ui –∏–ª–∏ cli
- –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∏–º–æ–≤, —Ç–∞–±–ª–∏—Ü –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –≤ –ø–∞–ø–∫—É queries, —Å—É—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º